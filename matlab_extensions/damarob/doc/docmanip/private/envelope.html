
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<html xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>envelope</title>
      <meta name="generator" content="MATLAB 7.4">
      <meta name="date" content="2009-11-25">
      <meta name="m-file" content="envelope"><style>

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head>
   <body>
      <div class="content"><pre class="codeinput"><span class="keyword">function</span> lim = envelope(manip)

<span class="comment">% ENVELOPE find the minimum and maximum workspace coordinates x y z for a</span>
<span class="comment">% manipulator.</span>
<span class="comment">%   syntax: lim = envelope(manip)</span>
<span class="comment">%</span>
<span class="comment">%                  [xmin, xmax]</span>
<span class="comment">%           lim =  [ymin, ymax]</span>
<span class="comment">%                  [zmin, zmax]</span>
<span class="comment">%</span>
<span class="comment">% Copyright (C) 2009, by Carmine Dario Bellicoso and Marco Caputano.</span>
<span class="comment">% This file is part of GNU LGPLv2.1 DAMA^{ROB}</span>
<span class="comment">%    http://www.damarob.altervista.org</span>
<span class="comment">%</span>

<span class="comment">% q boundles</span>
q_min = double(manip.DH.table(:,6));              <span class="comment">% limits</span>
q_max = double(manip.DH.table(:,7));
r = manip.DH.r;                                   <span class="comment">% number of joints</span>
<span class="keyword">for</span> i = 1:1:r                                     <span class="comment">% check finite value limits</span>
    <span class="keyword">if</span> q_min(i) == -Inf
        <span class="keyword">if</span> manip.DH.table(i,5) == 0
            q_min(i) = -4;
        <span class="keyword">else</span>
            q_min(i) = -1;
        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="keyword">if</span> q_max(i) == Inf
        <span class="keyword">if</span> manip.DH.table(i,5) == 0
            q_max(i) = 4;
        <span class="keyword">else</span>
            q_max(i) = 1;
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>

x = cell(1,r);
xM = cell(1,r);
syms <span class="string">q</span>;
var = sym(zeros(1,r));
varM = sym(zeros(1,r));

<span class="keyword">for</span> i=1:1:r    <span class="comment">% FIND MIN MAX X</span>
    var(i) = q;
    varM(i)= q;
    varc = char(vpa(var,4));
    varMc = char(vpa(varM,4));
    x{i} = eval([<span class="string">'@(q)manip.func.x('</span>,varc(9:end-2),<span class="string">')'</span>]);
    xM{i} = eval([<span class="string">'@(q)-1*manip.func.x('</span>,varMc(9:end-2),<span class="string">')'</span>]);
    var(i) = fminbnd(x{i},q_min(i),q_max(i));
    varM(i) = fminbnd(xM{i},q_min(i),q_max(i));
<span class="keyword">end</span>
xmin = manip.func.x(double(var));
xmax = manip.func.x(double(varM));



<span class="keyword">for</span> i=1:1:r    <span class="comment">% FIND MIN MAX Y</span>
    var(i) = q;
    varM(i)= q;
    varc = char(vpa(var,4));
    varMc = char(vpa(varM,4));
    x{i} = eval([<span class="string">'@(q)manip.func.y('</span>,varc(9:end-2),<span class="string">')'</span>]);
    xM{i} = eval([<span class="string">'@(q)-1*manip.func.y('</span>,varMc(9:end-2),<span class="string">')'</span>]);
    var(i) = fminbnd(x{i},q_min(i),q_max(i));
    varM(i) = fminbnd(xM{i},q_min(i),q_max(i));
<span class="keyword">end</span>
ymin = manip.func.y(double(var));
ymax = manip.func.y(double(varM));



<span class="keyword">for</span> i=1:1:r    <span class="comment">% FIND MIN MAX Z</span>
    var(i) = q;
    varM(i)= q;
    varc = char(vpa(var,4));
    varMc = char(vpa(varM,4));
    x{i} = eval([<span class="string">'@(q)manip.func.z('</span>,varc(9:end-2),<span class="string">')'</span>]);
    xM{i} = eval([<span class="string">'@(q)-1*manip.func.z('</span>,varMc(9:end-2),<span class="string">')'</span>]);
    var(i) = fminbnd(x{i},q_min(i),q_max(i));
    varM(i) = fminbnd(xM{i},q_min(i),q_max(i));
<span class="keyword">end</span>
zmin = manip.func.z(double(var));
zmax = manip.func.z(double(varM));


lim = [xmin, xmax; ymin, ymax; zmin, zmax];
<span class="keyword">end</span>
</pre><p class="footer"><br>
            Published with MATLAB&reg; 7.4<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
function lim = envelope(manip)

% ENVELOPE find the minimum and maximum workspace coordinates x y z for a 
% manipulator.
%   syntax: lim = envelope(manip)
%
%                  [xmin, xmax]
%           lim =  [ymin, ymax]
%                  [zmin, zmax]
%
% Copyright (C) 2009, by Carmine Dario Bellicoso and Marco Caputano.
% This file is part of GNU LGPLv2.1 DAMA^{ROB}
%    http://www.damarob.altervista.org
%

% q boundles
q_min = double(manip.DH.table(:,6));              % limits
q_max = double(manip.DH.table(:,7));
r = manip.DH.r;                                   % number of joints
for i = 1:1:r                                     % check finite value limits
    if q_min(i) == -Inf
        if manip.DH.table(i,5) == 0
            q_min(i) = -4;
        else
            q_min(i) = -1;
        end
    end
    if q_max(i) == Inf
        if manip.DH.table(i,5) == 0
            q_max(i) = 4;
        else
            q_max(i) = 1;
        end
    end
end

x = cell(1,r);
xM = cell(1,r);
syms q;
var = sym(zeros(1,r));
varM = sym(zeros(1,r));

for i=1:1:r    % FIND MIN MAX X
    var(i) = q;
    varM(i)= q;
    varc = char(vpa(var,4));
    varMc = char(vpa(varM,4));
    x{i} = eval(['@(q)manip.func.x(',varc(9:end-2),')']);
    xM{i} = eval(['@(q)-1*manip.func.x(',varMc(9:end-2),')']);
    var(i) = fminbnd(x{i},q_min(i),q_max(i));
    varM(i) = fminbnd(xM{i},q_min(i),q_max(i));
end
xmin = manip.func.x(double(var));
xmax = manip.func.x(double(varM));



for i=1:1:r    % FIND MIN MAX Y
    var(i) = q;
    varM(i)= q;
    varc = char(vpa(var,4));
    varMc = char(vpa(varM,4));
    x{i} = eval(['@(q)manip.func.y(',varc(9:end-2),')']);
    xM{i} = eval(['@(q)-1*manip.func.y(',varMc(9:end-2),')']);
    var(i) = fminbnd(x{i},q_min(i),q_max(i));
    varM(i) = fminbnd(xM{i},q_min(i),q_max(i));
end
ymin = manip.func.y(double(var));
ymax = manip.func.y(double(varM));



for i=1:1:r    % FIND MIN MAX Z
    var(i) = q;
    varM(i)= q;
    varc = char(vpa(var,4));
    varMc = char(vpa(varM,4));
    x{i} = eval(['@(q)manip.func.z(',varc(9:end-2),')']);
    xM{i} = eval(['@(q)-1*manip.func.z(',varMc(9:end-2),')']);
    var(i) = fminbnd(x{i},q_min(i),q_max(i));
    varM(i) = fminbnd(xM{i},q_min(i),q_max(i));
end
zmin = manip.func.z(double(var));
zmax = manip.func.z(double(varM));


lim = [xmin, xmax; ymin, ymax; zmin, zmax];
end


##### SOURCE END #####
-->
   </body>
</html>